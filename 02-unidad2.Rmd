# Probabilidad y variables aleatorias

## Elementos de probabilidad

Los elementos de probabilidad son los conceptos fundamentales que se utilizan en la teoría de la probabilidad para describir y analizar eventos aleatorios. Algunos de ellos son: espacio muestral, eventos, función de probabilidad, variable aleatoria, distribución de probabilidad, entre otros.

Estos elementos son esenciales para el estudio de la probabilidad y su aplicación en la estadística y en muchas áreas de la ciencia, incluyendo la economía, la biología, la física, entre otras.

### Experimento y Espacio muestral 

En el contexto de la probabilidad, un **experimento** es definido como un proceso que genera resultados definidos. Y en cada una de las repeticiones del experimento, habrá uno y solo uno de los posibles resultados experimentales [@anderson, página 143]. 

::: {.example}
```{r experimentos, echo=FALSE}
tabla = matrix(c("Lanzar una moneda",
                 "Tomar una pieza para inspeccionarla",
                 "Realizar una llamada de ventas",
                 "Lanzar un dado",
                 "Jugar un partido de fútbol",
                 "Cara, cruz",
                 "Con defecto, sin defecto",
                 "Hay compra, no hay compra",
                 "1, 2, 3, 4, 5, 6",
                 "Ganar, perder, empatar"),
               byrow = F, ncol = 2)
kable(tabla, align = 'l', booktabs = TRUE,
      caption = "Experimentos y resultados",
      col.names = c("Experimento", "Resultado experimental"), escape = FALSE) |>
  kable_styling(full_width = FALSE, bootstrap_options = c("condensed", "striped"), latex_options = c("HOLD_position"))
```
:::

Al especificar todos los resultados experimentales posibles, está definiendo el **espacio muestral** de un experimento. En otras palabras, el espacio muestral de un experimentos es el conjunto de todos los resultados experimentales. Se usa la letra omega mayúscula ($\Omega$) para referirnos a este conjunto. Un elemento genérico de $\Omega$ se denota como $\omega$.

::: {.example}
Conduciendo hacia su trabajo, una persona debe pasar por tres semáforos. En cada cruce la persona puede detenerse (D) o continuar (C), de acuerdo con el color de la luz. ¿Cuál es el espacio muestral del experimento?

$$\Omega = \lbrace CCC, DDD, CCD, CDD, CDC, DCD, DDC, DDD \rbrace$$
:::

::: {.exercise}
Un fabricante de ropa deportiva produce pantalones deportivos en dos colores (azul y gris) y en cuatro tamaños diferentes (pequeño, mediano, grande y extra grande). ¿Cuál es el espacio muestral del experimento de elegir al azar un pantalón deportivo de la línea de producción de la empresa?
:::

::: {.exercise}
Un restaurante ofrece tres opciones de menú para el almuerzo: menú A, menú B y menú C. Además, cada menú se puede pedir con carne o con pescado. ¿Cuál es el espacio muestral del experimento de elegir al azar un menú para el almuerzo en este restaurante?
:::

::: {.exercise}
Una compañía de seguros de autos ofrece pólizas de seguro con dos niveles de cobertura (básico y completo) y dos tipos de franquicia (alta y baja). ¿Cuál es el espacio muestral del experimento de elegir al azar una póliza de seguro de auto de la compañía?
:::

### Eventos aleatorios

En principio, un **evento aleatorio** (o simplemente evento) es algún subconjunto del espacio muestral $\Omega$. Los eventos se anotan con una letra mayúscula a elección [@anderson, página 153].

A modo de ejemplo, consideren el experimento de lanzar un dado de 6 caras. 

$\Omega = \lbrace 1,2,3,4,5,6 \rbrace$

Luego, el evento correspondiente a obtener un número par estaá dado por:

A: obtener un número par $\rightarrow A = \lbrace 2,4,6 \rbrace$

::: {.exercise}
Experimento aleatorio: Lanzamiento de un dado. Evento aleatorio: Obtener un número par. ¿Cuál es el conjunto correspondiente al evento aleatorio?
:::

::: {.exercise}
Experimento aleatorio: Elegir una carta al azar de una baraja de 52 cartas. Evento aleatorio: Obtener una carta roja. ¿Cuál es el conjunto correspondiente al evento aleatorio?
:::

::: {.exercise}
Experimento aleatorio: Lanzar dos monedas. Evento aleatorio: Obtener dos caras. ¿Cuál es el conjunto correspondiente al evento aleatorio?
:::

::: {.exercise}
Experimento aleatorio: Elegir un estudiante al azar de una clase de 30 estudiantes. Evento aleatorio: Elegir a un estudiante que tenga una altura superior a 1,75 metros. ¿Cuál es el conjunto correspondiente al evento aleatorio?
:::

::: {.exercise}
Experimento aleatorio: Lanzar un dardo a una diana circular. Evento aleatorio: Obtener un lanzamiento dentro del círculo exterior de la diana. ¿Cuál es el conjunto correspondiente al evento aleatorio?
:::

### Probabilidad de un evento {#probabilidad-evento}

El concepto de probabilidad está asociado a la ocurrencia de un evento Sin embargo, el número que determina que tan factible es que dicho evento ocurra puede ser difícil de calcular. En este aspecto, como introducción, se hará uso de la definición clásica de probabilidad:

<center>*Probabilidad de que ocurra un evento* $= \displaystyle\frac{\text{Casos favorables}}{\text{Casos totales}}$</center>

Por ejemplo, la probabilidad de obtener un número par al lanzar un dado una vez es:

A: obtener un número par. $\rightarrow A = \lbrace 2,4,6 \rbrace$

$$P(A) = \frac{\text{Casos favorables}}{\text{Casos totales}} = \frac{\lbrace 2,4,6 \rbrace}{\lbrace 1,2,3,4,5,6 \rbrace} = \frac{3}{6}= \frac{1}{2}$$
**Nota:** La probabilidad de cualquier evento siempre estará entre 0 y 1. Los casos extremos suceden cuando los casos favorables son inexistentes o son la totalidad de casos posibles respectivamente.

::: {.exercise}
En una tienda de ropa hay 10 camisas rojas, 15 camisas azules y 20 camisas verdes. ¿Cuál es la probabilidad de que al escoger una camisa al azar, sea de color verde?
:::

::: {.exercise}
En un mercado hay 200 vendedores, de los cuales el 70% son hombres y el 30% son mujeres. Si se elige al azar un vendedor, ¿cuál es la probabilidad de que sea mujer?
:::

#### Propiedades {.unnumbered .unlisted}

A continuación se mencionan algunas propiedades relacionadas con probabilidades [@anderson, página 157].

1.  **Complemento de un evento:** Dado un evento $A$, el complemento de $A$ se define como el evento que consta de todos los casos muestrales que **no** están en $A$, y se denota por $A^c$. Por ejemplo, si consideramos el experimento de lanzar el dado, y el evento de obtener un número par ($A$), entonces, el complemento corresponde a obtener un número que no sea par ($A^c$). De lo anterior se tiene que
    
    ```{=tex}
    \begin{equation}
    P(A) + P(A^c) = 1
    (\#eq:complemento)
    \end{equation}
    ```
  
    ::: {.example}
    Considere el caso de un administrador de ventas que, después de revisar los informes de ventas, encuentra que el 80% de los contactos con clientes nuevos no producen ninguna venta. Si $A$ denota el evento **hubo venta**, entonces $A^c$ corresponde al      evento de **no hubo venta**. Si el administrador tiene que $P(A^c) = 0.8$, mediante la ecuación \@ref(eq:complemento) se ve que

    $$P(A) = 1 - P(A^c) = 1 - 0.8 = 0.2$$
    La conclusión es que la probabilidad de una venta en el contacto con un cliente nuevo es de 0.2.
    :::

2.  **Unión de dos eventos:** La unión de dos eventos $A$ y $B$ es el evento que contiene todos los casos muestrales que pertenecen a $A$ o $B$ o ambos. La unión se denota $A \cup B$.

3.  **Intersección de dos eventos:** Dados dos eventos $A$ y $B$, la intersección de $A$ y $B$ es el evento que contiene los casos muestrales que pertenecen tanto a $A$ como a $B$. La intersección se denota $A \cap B$.

4.  **Ley de la adición:** La ley de la adición proporciona una manera de calcular la probabilidad de que ocurra el evento $A$ o el evento $B$ o ambos. En otras palabras, esta ley se emplea para calcular la probabilidad de la unión de dos eventos. La ley de la adición se expresa de la siguiente manera.

    ```{=tex}
    \begin{equation}
    P(A\cup B) = P(A) + P(B) - P(A\cap B)
    (\#eq:leyadicion)
    \end{equation}
    ```
    
    ::: {.example}
    Considere el caso de una pequeña empresa de ensamble en la que hay 50 empleados. Se espera que todos los trabajadores terminen su trabajo a tiempo y que pase la inspección final. A veces, alguno de los empleados no satisface el estándar de desempeño, ya sea porque no termina a tiempo su trabajo o porque no ensambla bien una pieza. Al final del periodo de evaluación del desempeño, el jefe de producción encuentra que 5 de los 50 trabajadores no terminaron su trabajo a tiempo. 6 de los 50 trabajadores ensamblaron mal una pieza y 2 de los 50 trabajadores no terminaron su trabajo a tiempo y armaron mal una pieza.
    
    Sea
    
    ```{=tex}
    \begin{equation}
    \notag
    \begin{split}
    L &: \text{No se termino el trabajo a tiempo}\\
    D &: \text{Se armó mal la pieza}\\
    \end{split}
    \end{equation}
    ```
    
    La información de las frecuencias relativas lleva a las probabilidades siguientes.
    
    ```{=tex}
    \begin{equation}
    \notag
    \begin{split}
    P(L) &= \frac{5}{50} = 0.1\\
    P(D) &= \frac{6}{50} = 0.12\\
    P(L\cap D) &= \frac{2}{50} = 0.04\\
    \end{split}
    \end{equation}
    ```
    
    Después de analizar los datos del desempeño, el jefe de producción decide dar una calificación baja al desempeño de los trabajadores que no terminaron a tiempo su trabajo o que armaron mal alguna pieza; por tanto, el evento de interés es $L \cup D$. ¿Cuál es la probabilidad de que el jefe de producción de a un trabajador una calificación baja de desempeño?
    
    Esta pregunta se refiere a la unión de dos eventos. En concreto, se desea hallar $P(L\cup D)$, usando la ecuación \@ref(eq:leyadicion) se tiene
    
    $$P(L\cup D) = P(L) + P(D) - P(L\cap D)$$
    Como conoce las tres posibilidades del lado derecho de la expresión, se tiene
    
    $$P(L\cup D) = 0.1 + 0.12 - 0.04 = 0.18$$
    Estos cálculos indican que la probabilidad de que un empleado  elegido al azar obtenga una calificación baja por su desempeño es 0.18.
    :::
    
    ::: {.example}
    Considere un estudio reciente efectuado por el director de personal de una empresa de software. En el estudio encontró que el 30% de los empleados que se van de la empresa antes de dos años, lo hacen por estar insatisfechos con el salario, 20% se van de la empresa por estar descontentos con el trabajo y 12% por estar insatisfechos con las dos cosas, el salio y el trabajo. ¿Cuál es la probabilidad de que un empleado que se vaya de la empresa en menos de dos años lo haga por estar insatisfecho con el salario, con el trabajo o con las dos cosas?
    
    Sea 
    
    ```{=tex}
    \begin{equation}
    \notag
    \begin{split}
    S &: \text{El empleado se va de la empresa por insatisfacción con el salario}\\
    W &: \text{El empleado se va de la empresa por insatisfacción con el trabajo}\\
    \end{split}
    \end{equation}
    ```
    
    Se tiene $P(S) = 0.3$, $P(W) = 0.2$ y $P(S\cap W) = 0.12$. Al aplicar la ecuación \@ref(eq:leyadicion), de la ley de la adición, se tiene 
    
    $$P(S\cup W) = P(S) + P(W) - P(S\cap W) = 0.3+0.2-0.12 = 0.38$$
    Así, la probabilidad de que un empleado se vaya de la empresa por el salario o por el trabajo es 0.38.
    :::

5.  **Eventos mutuamente excluyentes:** Se dice que dos eventos son mutuamente excluyentes si, cuando un evento ocurre, el otro no puede ocurrir. Por lo tanto, para que A y B sean mutuamente excluyentes, se requiere que su intersección sea nula, es decir,

    ```{=tex}
    \begin{equation}
    \text{Si } A \cap B = \emptyset \text{, entonces, } P(A \cap B) = 0.
    (\#eq:excluyentes)
    \end{equation}
    ```
    
6.  **Ley de la adición para eventos mutuamente excluyentes:** En caso de que se cumplan las condiciones mencionadas en la ecuación \@ref(eq:excluyentes), se tiene el siguiente resultado para la ecuación \@ref(eq:leyadicion).

    ```{=tex}
    \begin{equation}
    \begin{split}
    P(A\cup B) &= P(A) + P(B) - P(A\cap B)\\
    &= P(A) + P(B) - 0\\
    P(A\cup B) &= P(A) + P(B)\\
    \end{split}
    (\#eq:leyadicion2)
    \end{equation}
    ```
    
    ::: {.exercise} 
    Suponga que tiene un espacio muestral con cinco resultados experimentales que son igualmente posibles: $E_1,E_2,E_3,E_4$ y $E_5$. Sean
       
    ```{=tex}
    \begin{equation}
    \notag
    \begin{split}
    A &= \lbrace E_1, E_2 \rbrace\\
    B &= \lbrace E_3, E_4 \rbrace\\
    C &= \lbrace E_2, E_3, E_5 \rbrace\\
    \end{split}
    \end{equation}
    ```
    
      a. Calcular $P(A)$, $P(B)$ y $P(C)$.
      b. Calcular $P(A \cup B)$. ¿$A$ y $B$ son mutuamente excluyentes?
      c. Determinar $A^c$, $C^c$, y calcular $P(A^c)$, $P(C^c)$.
      d. Determinar $A\cup B^c$, y calcular $P(A\cup B^c)$.
      e. Calcular $P(B\cup C)$.
    :::
   
    ::: {.exercise} 
    Datos sobre las 30 principales acciones y fondos balanceados proporcionan los rendimientos porcentuales anuales y a 5 años para el periodo que termina el 31 de marzo de 2000 (*The Wall Street Journal*, 10 de abril de 2000). Suponga que considera altos un rendimiento anual arriba de 50% y un rendimiento a cinco años arriba de 300% y cinco de los fondos tienen tanto un rendimiento anual arriba de 50% como un rendimiento a cinco años arriba de 300%.
    
      a. ¿Cuál es la probabilidad de un rendimiento anual alto y cuál es la probabilidad de un rendimiento a cinco años alto?
      b. ¿Cuál es la probabilidad de ambos, un rendimiento anual alto y un rendimiento a cinco años alto?
      c. ¿Cuál es la probabilidad de que no haya un rendimiento anual alto ni un rendimiento a cinco años alto?
    :::
    
    ::: {.exercise} 
    La oficina de Censos de Estados Unidos cuenta con datos sobre la cantidad de adultos jóvenes entre 18 y 24 años, que viven en casa de sus padres. Sea
    
    ```{=tex}
    \begin{equation}
    \notag
    \begin{split}
    M &= \text{Aldulto joven que vive en casa de sus padres}\\
    F &= \text{Aldulta joven que vive en casa de sus padres}\\
    \end{split}
    \end{equation}
    ```
    
    Si toma al azar un adulto joven y una adulta joven, los datos de dicha oficina permiten concluir que $P(M) = 0.56$ y $P(F) = 0.42$. La probabilidad de que ambos vivan encasa de sus padres es $0.24$.
    
      a. ¿Cuál es la probabilidad de que al menos uno de dos adultos jóvenes seleccionados viva en casa de sus padres?
      b. ¿Cuál es la probabilidad de que los dos adultos jóvenes seleccionados vivan en casa de sus padres?
    :::

## Variable aleatoria

Una variable aleatoria proporciona un medio para describir los resultados experimentales utilizando valores numéricos, es decir, una variable aleatoria asocia un valor numérico a cada uno de los resultados experimentales. Una variable aleatoria puede ser *discreta* o *continua*, depende del tipo de valores numéricos que asuma. [@anderson, página 187]

- Una variable aleatoria se denomina **discreta** si asume un número finito de valores o una sucesión infinita de valores tales como $0,1,2,\ldots$. Consideremos el siguiente experimento como ejemplo: un contador presenta el examen para certificarse como contador público. El examen tiene cuatro partes. Defina una variable aleatoria $x$ como $x =$ *número de partes del examen aprobadas*. Esta es una variable aleatoria discreta porque puede tomar el número finito de valores $0,1,2,3$ o $4$. Otros ejemplos se pueden apreciar en la tabla \@ref(tab:variablesdiscretas).

```{r variablesdiscretas, echo=FALSE}
tabla = matrix(c("Llamar a cinco clientes",
                 "Número de clientes que hacen un pedido",
                 "0,1,2,3,4,5",
                 "Inspeccionar un envío de 50 radios",
                 "Número de radios que tienen algún defecto",
                 "0,1,2,...,49,50",
                 "Hacerse cargo de un restaurante durante el día",
                 "Número de clientes",
                 "0,1,2,3,...",
                 "Vender un automóvil",
                 "Sexo del cliente",
                 "0 si el hombre, 1 si es mujer"),
               byrow = T, ncol = 3)
tabla = kable(tabla, align = c('l','l','c'), booktabs = TRUE,
      caption = "Ejemplos de variables aleatorias discretas",
      col.names = c("Experimento", "Variable aleatoria (X)", "Valores posibles para la variable aleatoria"), escape = FALSE) |>
  kable_styling(full_width = FALSE, bootstrap_options = c("condensed", "striped"), latex_options = c("HOLD_position", "scale_down"))

if (knitr:::is_latex_output()) {
  tabla = tabla |>
    column_spec(1, width = "4cm") |> 
    column_spec(2, width = "6cm") |> 
    column_spec(3, width = "4cm")
}
tabla
```

- Una variable aleatoria se denomina **continua** si puede tomar cualquier valor numéricos dentro de un intervalo. Los resultados experimentales basados en escalas de medición tales como tiempo, peso, distancia y temperatura puede ser descritos por variables aleatorias continuas. Consideremos el siguiente experimento como ejemplo: observar las llamadas telefónicas que llegan a la oficina de atención de una importante empresa de seguros. La variable aleatoria que interesa es $x =$ *tiempo en minutos entre dos llamadas consecutivas*. Esta variable aleatoria puede tomar cualquier valor en el intervalo $[0, \infty)$. En efecto, $x$ puede tomar un número infinito de valores, entre los cuales se encuentra valores como 1.25 minutos 3.4562 minutos, 4.33333 minutos, etc. En la tabla  \@ref(tab:variablescontinuas) aparecen otros ejemplos de variables aleatorias continuas.

```{r variablescontinuas, echo=FALSE}
tabla = matrix(c("Operar un banco",
                 "Tiempo en minutos entre la llegada de los clientes",
                 "$x\\geq 0$",
                 "Llenar una lata de bebida (máximo 12.1 onzas)",
                 "Cantidad de onzas",
                 "$0\\leq x \\leq 12.1$",
                 "Contruir una biblioteca",
                 "Porcentaje del proyecto terminado en seis meses",
                 "$0\\leq x \\leq 100$",
                 "Probar un proceso químico nuevo",
                 "Temperatura a la que tiene lugar la reacción deseada (mín. 150 grados F, máx. 212 grados F)",
                 "$150\\leq x \\leq 212$"),
               byrow = T, ncol = 3)
tabla = kable(tabla, align = c('l','l','c'), booktabs = TRUE,
      caption = "Ejemplos de variables aleatorias discretas",
      col.names = c("Experimento", "Variable aleatoria (X)", "Valores posibles para la variable aleatoria"), escape = FALSE) |>
  kable_styling(full_width = FALSE, bootstrap_options = c("condensed", "striped"), latex_options = c("HOLD_position", "scale_down"))

if (knitr:::is_latex_output()) {
  tabla = tabla |>
    column_spec(1, width = "4cm") |> 
    column_spec(2, width = "6cm") |> 
    column_spec(3, width = "4cm")
}
tabla
```

::: {.example}
A continuación se da una serie de experimentos y su variable aleatoria correspondiente. En cada caso determine qué valores toma la variable aleatoria y diga si se trata de una variable aleatoria discreta o continua.
:::

```{r echo=FALSE}
tabla = matrix(c("a.",
                 "Hacer un examen con 20 preguntas",
                 "Número de preguntas contestadas correctamente",
                 "b.",
                 "Obervar los automóviles que llegan a una caseta de peaje en 1 hora",
                 "Número de automóviles que llegan a la casea de peaje",
                 "c.",
                 "Revisar 50 declaraciones de impuestos",
                 "Número de declaracionex que tienen algún error",
                 "d.",
                 "Observar trabar a un empleado",
                 "Número de horas no productivas en una jornada de 8 horas",
                 "e.",
                 "Pesar un envío",
                 "Número de libras"),
               byrow = T, ncol = 3)
tabla = kable(tabla, align = 'l', booktabs = TRUE,
      col.names = c("", "Experimento", "Variable aleatoria (X)"), escape = FALSE) |>
  kable_styling(full_width = FALSE, bootstrap_options = c("condensed", "striped"), latex_options = c("HOLD_position","scale_down"))

if (knitr:::is_latex_output()) {
  tabla = tabla |>
    column_spec(1, width = "0.5cm") |> 
    column_spec(2, width = "5cm") |> 
    column_spec(3, width = "5cm")
}
tabla
```

## Variables aleatorias discretas (v.a.d)

La distribución de probabilidad de una variable aleatoria discreta describe como se distribuyen las probabilidades entre los valores de la variable aleatoria. En el caso de una variable aleatoria discreta $x$, la distribución de probabilidad está definida por una función de probabilidad o también llamada **función de masa de probabilidad** (fmp) [@Devore, página 90].

### Función de masa de probabilidad

Consideremos el siguiente ejemplo, una empresa acaba de adquirir cuatro impresoras láser y sea $X$ el número entre estas que requieres servicio durante el periodo de garantía. Los posibles valores de $X$ son entonces 0, 1, 2, 3 y 4. La distribución de probabilidad diría cómo está subdividida la probabilidad de 1 entre los cinco posibles valores: cuánta probabilidad está asociada con el valor 0 de $X$, cuánta está adjudicada con 1 de $X$ y así sucesivamente. Se utiliza la siguiente notación para las probabilidades:

$$p(0) = \text{la probabilidad del valor 0 de } X = P(X = 0)$$

$$p(1) = \text{la probabilidad del valor 1 de } X = P(X = 1)$$
y así sucesivamente. En general, $p(x)$ denotará la probabilidad asignada al valor de $x$.


::: {.example}
Una cierta gasolinera tiene seis bombas. Sea $X$ el número de bombas que están bajo servicio a una hora particular del día. Suponga que la distribución de probabilidad de $X$ es como se detalla en la siguiente tabla; la primera fila de la tabla contiene los posibles valores de $X$ y la segunda la probabilidad de dicho valor.

```{r ejemplomasa, echo=FALSE}
tabla = matrix(c("$x$",0:6,"$p(x)$",0.05,0.10,0.15,0.25,0.20,0.15,0.10),
               byrow = T, nrow = 2)
kable(tabla, align = 'c', booktabs = TRUE, escape = FALSE) |>
  kable_styling(full_width = FALSE, bootstrap_options = c("condensed", "striped"), latex_options = c("HOLD_position"))
```

Ahora, utilizando propiedades de probabilidad elemental (revisar las propiedades mencionadas en la sección \@ref(probabilidad-evento)) es posible calcular otras probabilidades de interés. Por ejemplo, la probabilidad de que cuando dos gasolineras estén en servicio es

$$P(X\leq 2) = P(X = 0 \text{ o } 1 \text{ o } 2) = p(0) + p(1) + p(2) = 0.05 + 0.1 + 0.15 = 0.3$$
Por otro lado, la probabilidad de que entre 2 y 5 gasolineras inclusive estén en servicio es

$$P(2\leq X\leq 4) = P(X = 2 \text{ o } 3 \text{ o } 4) = p(2) + p(3) + p(4) = 0.15 + 0.25 + 0.2 = 0.6$$
:::

La figura \@ref(fig:plotmasa) está reproducida mediante R, con la finalidad de visualizar la función de masa asociada al ejemplo.

```{r plotmasa, fig.align="center", fig.width=5, fig.height=2.5, fig.cap="Función de masa"}
df = data.frame("x" = 0:6, # Valores de X
                "p" = c(0.05,0.10,0.15,0.25,0.20,0.15,0.10)) # Probabilidades asociadas
ggplot(
  data = df, 
  aes(x = x,
      y = p)) +
  geom_point() +
  geom_segment(
    aes(x = 0:6,
        y = rep(0,7),
        xend = 0:6,
        yend = p)) +
  labs(
    title = "Probabilidades de cada valor",
    x = "Valores del experimento (x)",
    y = "Probabilidades")
```

Cabe mencionar que cualquier función de masa de probabilidad requiere cumplir las siguientes condiciones

1. $p(x) >0, \forall x \in X$
2. $\displaystyle\sum_{\text{todas las x posibles}} p(x) = 1$

para que se válida.

::: {.exercise}
Seis lotes de componentes están listos para ser enviados por un proveedor. El número de componentes defectuosos en cada lote es como sigue:

```{r echo=FALSE}
tabla = matrix(c("Lote",1:6,"Número de defectuosos",0,2,0,1,2,0),
               byrow = T, nrow = 2)
kable(tabla, align = c('l','c'), booktabs = TRUE, escape = FALSE, linesep = "") |>
  kable_styling(full_width = FALSE, bootstrap_options = c("condensed", "striped"), latex_options = c("HOLD_position")) |>
  column_spec(1, bold = TRUE)
```
:::

Uno de estos lotes tiene que ser seleccionado al azar para ser enviado a un cliente particular. Sea $X$ el número de defectuosos en el lote seleccionado. Los tres posibles valores de $X$ son 0, 1 y 2.
    
  a. Determine los la probabilidad para cada uno de los valores de $X$. Interprete.
  b. Verifique las condiciones de la función de masa de probabilidad asociada al experimento.
  c. Grafique la función de masa asociada.

::: {.exercise #telefonica}
Una empresa de ventas en línea dispone de seis líneas telefónicas. Sea $X$ el número de líneas en uso en un tiempo epsecificado. Suponga que la función de masa de probabilidad de $X$ es la que se da en la tabla adjunta.

```{r echo=FALSE}
tabla = matrix(c("$x$",0:6,"$p(x)$",0.1,0.15,0.2,0.25,0.2,0.06,0.04),
               byrow = T, nrow = 2)
kable(tabla, align = 'c', booktabs = TRUE, escape = FALSE) |>
  kable_styling(full_width = FALSE, bootstrap_options = c("condensed", "striped"), latex_options = c("HOLD_position"))
```

Grafique la función de masa asociada, y luego calcule la probabilidad de cada uno de los siguientes eventos.

  a. Cuando mucho tres líneas están en uso.
  b. Menos de tres líneas están en uso.
  c. Por o menos tres líneas están en uso.
  d. entre dos y cinco líneas, inclusive, están en uso.
  e. Entre dos y cuatro líneas, inclusive, no está en uso.
  f. Por lo menos cuatro líneas no están en uso.
:::

### Función de distribución acumulada

Para algún valor fijo de $x$, a menudo se desea calcular la probabilidad de que el valor observado de $X$ sea cuando mucho $x$ ($X \leq x$). Por ejemplo, consideremos la siguiente función de masa.

```{=tex}
\begin{equation}
\notag
\begin{split}
P(X = x) = p(x) = \left\lbrace
\begin{matrix}
0.5 & x = 0\\
0.167 & x = 1\\
0.333 & x = 2\\
0 & \text{en otro caso}\\
\end{matrix}
\right.
\end{split}
\end{equation}
```

La probabilidad de que $X$ sea cuando mucho de 1 es entonces

$$P(X \leq 1) = p(0) + p(1) = 0.5 + 0.167 = 0.667$$
Asimismo,

$$P(X \leq 0) = P(X = 0) = 0.5.$$

La **función de distribución acumulada** (fda) $F(x)$ de una variable aleatoria discreta $X$ con función de masa de probabilidad $P(X=x)$ se define como

```{=tex}
\begin{equation}
F(x) = P(X\leq x) =\displaystyle\sum_{y\leq x}P(X=y)
(\#eq:fdadiscreta)
\end{equation}
```

Para cualquier número $x$, $F(X)$ es la probabilidad de que el valor observado de $X$ será cuando mucho (como máximo) $x$. [@Devore, página 95]

::: {.example}
Consideremos un grupo de cinco donadores de sangre potenciales, $a, b, c, d$ y $e$, de los cuales solo $a$ y $b$ tienen sangre tipo O+. Se determinará en orden aleatorio el tipo de sangre con cinco muestra, una de cada individuo hasta que identifique un individuo O+. Sea la variable aleatoria $Y =$ *el número de exámenes de sangre para identificar un individuo O+*. Entonces la función de masa de probabilidad de $Y$ es

```{r echo=FALSE}
tabla = matrix(c("$y$",1:4,"$p(y)$",0.4,0.3,0.2,0.1),
               byrow = T, nrow = 2)
kable(tabla, align = 'c', booktabs = TRUE, escape = FALSE) |>
  kable_styling(full_width = FALSE, bootstrap_options = c("condensed", "striped"), latex_options = c("HOLD_position"))
```

Para determinar la función de distribución acumulada $F(Y)$, lo primero es determinar el valor de $F(Y)$ para cada uno de los valores posibles del conjunto ($1,2,3,4$):

```{=tex}
\begin{equation}
\notag
\begin{split}
F(1) &= P(Y\leq 1) = P(Y = 1) = p(1) = 0.4\\
F(2) &= P(Y\leq 2) = P(Y = 1 \text{ o } 2) = p(1) + p(2) = 0.7\\
F(3) &= P(Y\leq 3) = P(Y = 1 \text{ o } 2 \text{ o } 3) = p(1) + p(2) + p(3) = 0.9\\
F(4) &= P(Y\leq 4) = P(Y = 1 \text{ o } 2 \text{ o } 3 \text{ o } 4) = p(1) + p(2) + p(3) + p(4) = 0.1\\
\end{split}
\end{equation}
```

Ahora con cualquier otro número $y$, $F(Y)$ será igual al valor de $F$ con el valor más próximo posible de $Y$ a la izquierda de $y$. Por ejemplo, $F(2.7) = P(Y\leq 2.7) = p(Y\leq 2) = 0.7$ y $F(3.9999) = F(3) = 0.9$. La función de distribución acumulativa es por lo tanto

```{=tex}
\begin{equation}
\notag
\begin{split}
F(y) = \left\lbrace
\begin{matrix}
0 & \text{si } y < 1\\
0.4 & \text{si } 1\leq y < 2\\
0.7 & \text{si } 2\leq y < 3\\
0.9 & \text{si } 3\leq y < 4\\
1 & \text{si } y\geq 4\\
\end{matrix}
\right.
\end{split}
\end{equation}
```

La siguiente figura muestra una gráfica de $F(y)$.

```{r fig.align="center", fig.width=5, fig.height=2.5, fig.cap="Función de distribución acumulada"}
df = data.frame("y" = 1:4, # Valores de Y
                "p" = c(0.4,0.7,0.9,1)) # Probabilidades acumuladas asociadas
ggplot(
  data = df, 
  aes(x = y,
      y = p)) +
  geom_segment(
    aes(x = c(y[1],y[-length(y)]),
        y = c(y[1],p[-length(y)]),
        xend = c(1,y[-1]),
        yend = c(1,p[-length(y)]))) +
  geom_segment(
    aes(x = y[length(y)],
        y = p[length(y)],
        xend = y[length(y)] + mean(y[2:length(y)]- y[1:length(y)-1]),
        yend = p[length(y)]),
    arrow = arrow(length = unit(0.2, "cm")),
    alpha = 0.4) +
  geom_point(col = "darkred") +
  scale_y_continuous(limits = c(0,1)) +
  labs(
    title = "Probabilidad acumulada",
    x = "Valores de y",
    y = "F(y)")
```
Para una variable aleatorio discreta $X$, la gráfica de $F(X)$ mostrará un saltó con cada valor posible de $X$ y será plana entre los valores posibles. Tal gráfica se conoce como función escalonada.
:::

Una propiedad que surge de la función de distribución acumulada es que, para dos números cualesquiera $a$ y $b$ con $a\leq b$.

```{=tex}
\begin{equation}
P(a\leq X \leq b) = P(X \leq b) - P(X < a)
(\#eq:fda2)
\end{equation}
```

En caso de que se desee calcular $P(a < X \leq b)$, la propiedad sería

```{=tex}
\begin{equation}
P(a < X \leq b) = P(X \leq b) - P(X \leq a) = F(a) - F(b)
(\#eq:fda3)
\end{equation}
```

De lo anterior se deduce, que dependiendo de los signos de desigualdad, cambiará la forma en la se escribe la propiedad.

::: {.exercise}
Remítase al ejercicio \@ref(exr:telefonica) y calcule y trace la gráfica de la función de distribución acumulada $F(X)$. Luego, utilícela para calcular las probabilidades de los eventos dados en los ítem a. y d. de dicho problema. Además, grafique la función de distribución acumulada.
:::

::: {.exercise}
Una organización de protección al consumidor que habitualmente evalúa automóviles nuevos reporta el número de defectos importantes encontrados en un carro seleccionado al azar de cierto tipo. La función de distribución acumulativa de $Y$ es la siguiente.

```{=tex}
\begin{equation}
\notag
\begin{split}
F(y) = \left\lbrace
\begin{matrix}
0 & \text{si } y < 1\\
0.06 & \text{si } 0\leq y < 1\\
0.19 & \text{si } 1\leq y < 2\\
0.39 & \text{si } 2\leq y < 3\\
0.67 & \text{si } 3\leq y < 4\\
0.92 & \text{si } 4\leq y < 5\\
0.97 & \text{si } 5\leq y < 6\\
1 & \text{si } y\geq 6\\
\end{matrix}
\right.
\end{split}
\end{equation}
```

1.  Calcule las siguientes probabilidades directamente con la función de distribución acumulada:

    a. $p(2)$, es decir, $P(Y=2)$
    b. $P(Y>3)$
    c. $P(2\leq Y\leq 5)$
    d. $P(2 < Y < 5)$
    
2.  ¿Cuál es la función de masa de probabilidad de  $X$? Grafique la función de masa de probabilidad, y la función de distribución acumulada.
:::

### Distribuciones

A continuación se dan a conocer algunas de las distribución de probabilidad discreta más utilizadas. Cabe mencionar, que existen muchas otras distribuciones, por lo que se invita al lector a informarse de ellas en caso de lo requiera.

#### Uniforme {.unlisted .unnumbered} 

El ejemplo más sencillo de de una distribución de probabilidad discreta dada mediante una fórmula es la **distribución uniforme discreta** [@anderson, página 191]. Su función de masa de probabilidad está definida por 

```{=tex}
\begin{equation}
P(X=x) = \dfrac{1}{n}
(\#eq:uniformediscreta)
\end{equation}
```

donde

$$n = \text{número de valores que puede tomar la variable aleatoria.}$$

::: {.example}
Consideremos el experimento de lanzar un dado de seis caras. Se define la variable aleatoria $X$ como el número de puntos en la cara del dado que cae hacia arriba. En este experimento la variable aleatoria toma 6 valores posibles ($n = 6$). Por lo tanto, la función de masa de probabilidad de esta variable aleatoria uniforme discreta es

$$P(X = x)=1/6 \text{, } x = 1,2,3,4,5,6$$
:::

La figura \@ref(fig:simUD), muestra una simulación de la función de masa de probabilidad de la distribución uniforme discreta, dependiendo del número de valores que puede tomar la variable aleatoria ($n$).

```{r simUD, fig.align="center", fig.width=7, fig.height=4, fig.cap="Simulación de la distribución Uniforme discreta", echo=FALSE}
u = function(n, titulo){
  aux = data.frame("x" = seq(1:n), "y" = 1/n)
  g = ggplot(data = aux, aes(x = x, y = y)) +
    geom_point() + 
    geom_segment(aes(x = x, xend = x, y = 0, yend = y)) + 
    labs(x = "Observación", y = "Probabilidad", title = titulo) + 
    scale_y_continuous(limits = c(0,1)) + 
    scale_x_continuous(breaks = 1:n)
  return(g)
}
grid.arrange(u(2, "2 observaciones"),
             u(5, "5 observaciones"),
             u(10, "10 observaciones"),
             u(20, "30 observaciones"),
             ncol = 2)
```


#### Bernoulli {.unlisted .unnumbered}

La distribución Bernoulli es una distribución de probabilidad discreta que describe el resultado de un experimento de ensayo único que puede tener dos posibles resultados, a menudo etiquetados como éxito y fracaso, con una probabilidad de éxito de $p$ y una probabilidad de fracaso de $q = 1 - p$. La función de masa de probabilidad de la distribución Bernoulli está dada por:

```{=tex}
\begin{equation}
P(X = x) = p^x(1-p)^{1-x}
(\#eq:bernoulli)
\end{equation}
```

donde $x$ puede tomar únicamente los valores de 0 y 1 [@larsen, página 105]. 

La figura \@ref(fig:simBer), muestra una simulación de la función de masa de probabilidad de la distribución Bernoulli, dependiendo de  la probabilidad de éxito ($p$).

```{r simBer, fig.align="center", fig.width=7, fig.height=4, fig.cap="Simulación de la distribución Binomial", echo=FALSE}
ber = function(p, titulo){
  aux = data.frame("x" = c("Éxito", "Fracaso"), "y" = c(p, 1-p))
  g = ggplot(data = aux, aes(x = x, y = y)) +
    geom_point() + 
    geom_segment(aes(x = x, xend = x, y = 0, yend = y)) + 
    labs(x = "Observación", y = "Probabilidad", title = titulo) + 
    scale_y_continuous(limits = c(0,1))
  return(g)
}
grid.arrange(ber(0.1, "Probabilidad de éxito de 0.1"),
             ber(0.4, "Probabilidad de éxito de 0.4"),
             ber(0.6, "Probabilidad de éxito de 0.6"),
             ber(0.8, "Probabilidad de éxito de 0.8"),
             ncol = 2)
```

::: {.example}
En un experimento de lanzamiento de moneda, se puede modelar la probabilidad de obtener cara como una distribución Bernoulli. En este caso, si se define "éxito" como obtener cara y "fracaso" como obtener sello, entonces la probabilidad de éxito es $p = 0.5$ y la probabilidad de fracaso es $q = 1 - p = 0.5$. Entonces, la distribución Bernoulli para este experimento estaría dada por:

- $P(\text{Obtener cara}) = p = 0.5$
- $P(\text{Obtener sello}) = q = 0.5$
:::

::: {.example}
En una campaña publicitaria en línea, se puede modelar la probabilidad de que un usuario haga clic en un anuncio como una distribución Bernoulli. En este caso, si se define "éxito" como un usuario que hace clic en el anuncio y "fracaso" como un usuario que no hace clic, entonces la probabilidad de éxito es p y la probabilidad de fracaso es $q = 1 - p$. Supongamos que la probabilidad de que un usuario haga clic en el anuncio es del 10%, es decir, $p = 0.1$. Entonces, la distribución Bernoulli para este experimento estaría dada por:

- $P(\text{Hacer clic en el anuncio}) = p = 0.1$
- $P(\text{No hacer clic en el anuncio}) = q = 0.9$
:::

#### Binomial {.unlisted .unnumbered} 

La distribución de probabilidad binomial es una distribución de probabilidad que tiene muchas aplicaciones. Está relacionada con un experimento de pasos múltiples al que se llama experimento binomial [@anderson, paǵina 200].

Un experimento binomial tiene las siguientes cuatro propiedades.

1. El experimento consiste en una serie de n ensayos idénticos.
2. En cada ensayo hay dos resultados posibles. A uno de estos resultados se le llama éxito y al otro se le llama fracaso.
3. La probabilidad de éxito, que se denota $p$, no cambia de un ensayo a otro. Por ende, la probabilidad de fracaso, que se denota $1 - p$, tampoco cambia de un ensayo a otro.
4. Los ensayos son independientes.

Si se presentan las propiedades $2, 3$ y $4$, se dice que los ensayos son generados por un proceso de Bernoulli. Si, además, se presenta la propiedad 1, se trata de un experimento binomial.

En un experimento binomial lo que interesa es el número de éxitos en n ensayos. Si $X$ denota el número de éxitos en $n$ ensayos, es claro que $x$ tomará los valores $0, 1, 2, 3, \ldots, n$. Dado que el número de estos valores es finito, $X$ es una variable aleatoria discreta. A la distribución de probabilidad correspondiente a esta variable aleatoria se le llama **distribución de probabilidad binomial**.

::: {.example}
Considere el experimento que consiste en lanzar una moneda cinco veces y observar si la cara de la moneda que cae hacia arriba es cara o cruz. Suponga que se desea contar el número de caras que aparecen en los cinco lanzamientos. ¿Presenta este experimento las propiedades de un experimento binomial? ¿Cuál es la variable aleatoria que interesa? Observe que:

1. El experimento consiste en cinco ensayos idénticos; cada ensayo consiste en lanzar una moneda.
2. En cada ensayo hay dos resultados posibles: cara o cruz. Se puede considerar cara como éxito y cruz como fracaso.
3. La probabilidad de éxito y la probabilidad de fracaso son iguales en todos los ensayos, siendo $p = 0.5$ y $1 - p = 0.5$.
4. Los ensayos o lanzamientos son independientes porque al resultado de un ensayo no afecta a lo que pase en los otros ensayos o lanzamientos.

Por tanto, se satisfacen las propiedades de un experimento binomial. La variable aleatoria que interesa es $X =$ número de caras que aparecen en cinco ensayos. En este caso, X puede tomar los valores $0, 1, 2, 3, 4$ o $5$.
:::

La función de masa de probabilidad de la distribución Binomial está dada por:

```{=tex}
\begin{equation}
P(X = x) = \binom{n}{x}p^x(1-p)^{n-x}
(\#eq:binomial)
\end{equation}
```

donde

```{=tex}
\begin{equation}
\notag
\begin{split}
P(X = x) &= \text{probabilidad de } x \text{ éxitos en } n \text{ ensayos}\\
n &= \text{ número de ensayos}\\
\binom{n}{x} &= \dfrac{n!}{x!(n-x!)}\\
p &= \text{probabilidad de un éxito en cualquiera de los ensayos}\\
1 - p &= \text{probabilidad de un fracaso en cualquiera de los ensayos}\\
\end{split}
\end{equation}
```

La figura \@ref(fig:simBinomial), muestra una simulación de la función de masa de probabilidad de la distribución Binomial, dependiendo del número de ensayos ($n$) y de la probabilidad de éxito ($p$). 

```{r simBinomial, fig.align="center", fig.width=7, fig.height=4, fig.cap="Simulación de la distribución Binomial", echo=FALSE}
bin = function(p, titulo){
  aux = data.frame("x" = seq(1,10), "y" = dbinom(1:10,10,p))
  g = ggplot(data = aux, aes(x = x, y = y)) +
    geom_point() + 
    geom_segment(aes(x = x, xend = x, y = 0, yend = y)) + 
    labs(x = "Observación", y = "Probabilidad", title = titulo) + 
    scale_y_continuous(limits = c(0,1)) + 
    scale_x_continuous(breaks = 1:10)
  return(g)
}
grid.arrange(bin(0.1, "Binomial, n = 10, p = 0.1"),
             bin(0.4, "Binomial, n = 10, p = 0.4"),
             bin(0.6, "Binomial, n = 10, p = 0.6"),
             bin(0.8, "Binomial, n = 10, p = 0.8"),
             ncol = 2)
```

::: {.example #ejcomandosbin}
Considere una distribución Binomial con $n = 7$ y $p = 0.4$.

a.  Escriba la función de masa de probabilidad asociada.

    ```{=tex}
    \begin{equation}
    \notag
    P(X=x) = \binom{7}{x}0.4^x(1-0.4)^{7-x}
    \end{equation}
    ```

b.  Calcule $p(4)$.

    Recordemos que $p(4) = P(X = 4)$. Para poder calcular probabilidades en un punto exacto (igual a 4) en R, se debe usar el prefijo *d* seguido de la abreviatura de la distribución discreta, en este caso la abreviatura de la distribución Binomial es *binom*.
    
    ```{r}
    dbinom(
      x = 4, # Valor de X para el cual se desea calcular la probabilidad
      size = 7, # Cantidad de ensayos
      prob = 0.4, # Probabilidad de éxito
    )
    ```    
    
    Por lo tanto, la probabilidad de obtener 4 resultados exitosos de 7 ensayos es de 0.19.
    
c.  Calcule $P(X\leq 2)$.

    En R para poder calcular probabilidades acumuladas es posible usar el prefijo *p* seguido de la abreviatura de la distribución discreta, en este caso la abreviatura de la distribución Binomial es *binom*. 
    
    Por defecto, R considera que las probabilidades acumuladas son del tipo $P(X \leq x)$, tal como se presenta en este enunciado.

    ```{r}
    pbinom(
      q = 2, # Se consideran valores MENORES o iguales a 2
      size = 7, # Cantidad de ensayos
      prob = 0.2, # Probabilidad de éxito
    )
    ```
    
    Por lo tanto, la probabilidad de obtener 2 o menos resultados exitosos de 7 ensayos es de 0.85.

d.  Calcule $P(X < 5)$.

    En este caso antes de calcular en la probabilidad en R, se debe transformar la expresión a la forma $P(X \geq x)$. Ya que estamos trabajando con eventos discretos, tenemos que 
    
    $$P(X < 5) = P(X \leq 4)$$
    
    Luego, esta probabilidad la podemos calcular en R de la siguiente manera.
    
    ```{r}
    pbinom(
      q = 4, # Se consideran valores MENORES o iguales a 4
      size = 7, # Cantidad de ensayos
      prob = 0.2, # Probabilidad de éxito
    )
    ```

    Por lo tanto, la probabilidad de obtener menos de 5 resultados exitosos de 7 ensayos es de 0.99.

e.  Calcule $P(X > 1)$.

    R incluye un comando para aquellos casos en los que el signo de desigualdad no estricto está invertido si es esctricto, es decir, en vez de $\leq$ se tiene $>$.
    
    ```{r}
    pbinom(
      q = 1, # Se consideran valores MAYORES o iguales a 1
      size = 7, # Cantidad de ensayos
      prob = 0.2, # Probabilidad de éxito
      lower.tail = FALSE # En caso de que se tenga el signo mayor estricto
    )
    ```
    
    Por lo tanto, la probabilidad de obtener más de 1 resultado exitoso de 7 ensayos es de 0.42.

f.  Calcule $P(X \geq 1)$.

    Para aquellos casos en que se tenga el signo de mayor no estricto ($\geq$), lo más más recomendable es transformar la expresión a no estricto ($>$) para así utilizar un código similar al del ejemplo *d.*. Ya que estamos trabajando con eventos discretos, tenemos que
    
    $$P(X \geq 1) =P(X > 0)$$
    
    Luego, esta probabilidad la podemos calcular en R de la siguiente manera.    
    
    ```{r}
    pbinom(
      q = 0, # Se consideran valores MAYORES a 0
      size = 7, # Cantidad de ensayos
      prob = 0.2, # Probabilidad de éxito
      lower.tail = FALSE # En caso de que se tenga el signo mayor estricto
      )
    ```

    Por lo tanto, la probabilidad de obtener al menos 1 resultado exitoso de 7 ensayos es de 0.79.

g.  ¿Para que valor de $x$, $P(X \leq x) = 0.6$?

    Despejar esta ecuación puede llegar a ser engorroso. Sin embargo, R posee un argumento para determinar estos valores. Para el calculo se debe usar el prefijo *q* seguido de la abreviatura de la distribución discreta, en este caso la abreviatura de la distribución Binomial es *binom*.
    
    ```{r}
    qbinom(
      p = 0.6, # Valor resultante de la probabilidad
      size = 7, # Cantidad de ensayos
      prob = 0.2, # Probabilidad de éxito
      )
    ```
    
    Por lo tanto, para $x = 2$, la probabilidad de obtener a lo más $x$ resultados exitosos es de 0.6.
:::

::: {.example}
Un acusado va a ser declarado inocente o culpable por un jurado popular. Para ser condenado es necesario que al menos 7 personas de las 10 del jurado voten culpable. Dado que en los programas de televisión ya han dado muchos detalles del caso, los miembros del jurado están atendiendo \textit{twitter} o leyendo el diario en vez de escuchar al fiscal y al abogado, porque van a decidir tirando una moneda al aire. ¿Cuál es la probabilidad de que el acusado sea declarado inocente?

La probabilidad de éxito (inocencia) es de $p = 0.5$. Sea $X$ el número éxitos (votos de inocencia) en 10 ensayos (votos del jurado). Entonces, la probabilidad de ser declarado inocente esta dada por la siguiente expresión.

$$
P(X \geq 4) = \sum_{k=4}^{10} \binom{10}{k} 0.5^{k}(1-0.5)^{10-k} = 0.82,\text{ o}
$$

Antes de realizar el cálculo en R lo recomendable es transformar la expresión para utilizar el comando adecuado. En este caso, la expresión es:

$$P(X\geq 4) = P(X > 3)$$
Luego, en R.

```{r}
pbinom(
  q = 3, # Se consideran valores MAYORES o iguales a 3 (es decir, mayor o igual a 4)
  size = 10, # Cantidad de ensayos
  prob = 0.5, # Probabilidad de éxito
  lower.tail = FALSE # TRUE: menor igual, FALSE: mayor estricto
)
```

Por otro lado, la probabilidad $P(X\geq 4)$ puede ser escrita como $1 - P(X \leq 3)$.

$$
1 - P(X \leq 3) = \sum_{k=0}^{3} \binom{10}{k} 0.5^{k}(1-0.5)^{10-k} = 0.82
$$

Es posible calcular esta expresión en R de la siguiente manera.

```{r}
1 - pbinom(
  q = 3, # Se consideran valores MENORES o iguales a 3
  size = 10, # Cantidad de ensayos
  prob = 0.5 # Probabilidad de éxito
)
```

Por lo tanto, la probabilidad de que el acusado sea declarado inocente es de 0.82.
:::

::: {.exercise}
En una planta de revisión técnica, resulta rechazado el $42 \%$ de los vehículos livianos.

1. En la primera media hora de un día cualquiera se alcanzan a revisar 9 vehículos ¿cuál es la probabilidad de que más de 3 sean rechazados?
2. Una mañana se rechazaron 25 vehículos de los cuales 8 fueron fabricados antes del año 2022. Un inspector revisa al azar los antecedentes de 5 vehículos rechazados ¿cuál es la probabilidad de que la mayoría de los vehículos revisados hayan sido fabricados antes del año 2022?
:::

::: {.exercise}
Se sabe que la probabilidad de que una empresa no pase la revisión de fraude fiscal es de 0.21. De las siguientes 345 empresas que se revisan en búsqueda de fraude fiscal, calcule la probabilidad de que al menos 10 empresas no aprueben la revisión.
:::

::: {.exercise}
Un banco sabe que el 3% de sus clientes no pagan a tiempo sus tarjetas de crédito. Si el banco emite 5000 tarjetas de crédito,

1.  ¿Cuál es la probabilidad de que al menos 200 de ellas pertenezcan a clientes que no pagan a tiempo?
2.  ¿Qué pasaría con la probabilidad de que al menos 200 de las tarjetas de crédito pertenezcan a clientes que no pagan a tiempo si la tasa de incumplimiento del banco aumenta al 5%?
3.  Si el banco quisiera reducir la probabilidad de que al menos 200 de las tarjetas de crédito pertenezcan a clientes que no pagan a tiempo a menos del 0.05%, ¿cuál debería ser el número máximo de tarjetas de crédito que debería emitir?
4.  ¿Cómo cambiaría la probabilidad de que al menos 200 de las tarjetas de crédito pertenezcan a clientes que no pagan a tiempo si el banco decidiera aumentar el número de tarjetas de crédito que otorga a cada cliente?
5.  ¿Cuál es la probabilidad de que exactamente 250 de las tarjetas de crédito pertenezcan a clientes que no pagan a tiempo?
:::

#### Poisson {.unlisted .unnumbered} 

Una variable aleatoria discreta que se suele usar para estimar el número de veces que sucede un hecho determinado (ocurrencias) en un intervalo de tiempo o de espacio. Por ejemplo, número de reparaciones  en un autopista o número de fugas en un tubería. Si se satisfacen las siguientes condiciones, el número de ocurrencias es una variable aleatoria discreta, descrita por la distribución de probabilidad de Poisson [@anderson, página 211].

1. La probabilidad de ocurrencia es la misma para cualesquiera dos intervalos de la misma magnitud.
2. La ocurrencia o no-ocurrencia en cualquier intervalo es independiente de la ocurrencia o no-ocurrencia en cualquier otro intervalo.

La función de masa de probabilidad de Poisson se define mediante la ecuación

```{=tex}
\begin{equation}
P(X = x) = \dfrac{\lambda^xe^{-\lambda}}{x!}
(\#eq:poisson)
\end{equation}
```

en donde

```{=tex}
\begin{equation}
\notag
\begin{split}
P(X = x) &= \text{probabilidad de } x \text{ ocurrencias en un intervalo de tiempo}\\
\lambda &= \text{ tasa de ocurrencias en un intervalo}\\
e &\approx 2.71828\\
\end{split}
\end{equation}
```

Es importante observar, que el número de ocurrencias de $x$, no tiene límite superior. Esta es un variable aleatoria discreta que toma los valores de una sucesión infinita de números ($x = 0,1,2,3,4,\ldots$).

La figura \@ref(fig:simPois), muestra una simulación de la función de masa de probabilidad de la distribución Poisson, dependiendo de la tasa en función del tiempo ($\lambda$).

```{r simPois, fig.align="center", fig.width=7, fig.height=4, fig.cap="Simulación de la distribución Poisson", echo=FALSE}
poi = function(lambda, titulo){
  aux = data.frame("x" = seq(1,8), "y" = dpois(1:8,lambda))
  g = ggplot(data = aux, aes(x = x, y = y)) +
    geom_point() + 
    geom_segment(aes(x = x, xend = x, y = 0, yend = y)) + 
    labs(x = "Observación", y = "Probabilidad", title = titulo) + 
    scale_y_continuous(limits = c(0,1)) + 
    scale_x_continuous(breaks = 1:10)
  return(g)
}
grid.arrange(poi(0.9, "Poisson, n = 8, lambda = 0.9"),
             poi(2.2, "Poisson, n = 8, lambda = 2.2"),
             poi(3.2, "Poisson, n = 8, lambda = 3.2"),
             poi(7.1, "Poisson, n = 8, lambda = 7.1"),
             ncol = 2)
```

::: {.example}
Considere una distribución Poisson con $\lambda = 3$

a.  Escriba la función de probabilidad asociada.

    ```{=tex}
    \begin{equation}
    \notag
    P(X=x) = \dfrac{3^xe^{-3}}{x!}
    \end{equation}
    ```
    
b.  Calcule $p(2)$.
    
    Considerando los comandos explicados en el ejemplo \@ref(exm:ejcomandosbin), solo es necesario modificar la abreviatura de la distribución de probabilidad, la cual, en este caso, corresponde a *pois*.
    
    Recordemos que $p(2) = P(X = 2)$.
    
    ```{r}
    dpois(
      x = 2, # Valor de X para el cual se desea calcular la probabilidad
      lambda = 3 # Tasa de ocurrencia por unidad de tiempo o espacio
      )
    ```
    
    Por lo tanto, teniendo una tasa de 3 por unidad de tiempo, la probabilidad de que ocurran dos sucesos es de 0.22. 
    
c.  Calcule $P(X\leq 3)$.
    
    ```{r}
    ppois(
      q = 3, # Valor de X para el cual se desea calcular la probabilidad
      lambda = 3 # Tasa de ocurrencia por unidad de tiempo o espacio
      )
    ```
    
    Por lo tanto, teniendo una tasa de 3 por unidad de tiempo, la probabilidad de que ocurran a lo más tres sucesos es de 0.64. 
    
d.  Calcule $P(X < 2)$.

    ```{r}
    ppois(
      q = 1, # Valor de X para el cual se desea calcular la probabilidad
      lambda = 3 # Tasa de ocurrencia por unidad de tiempo o espacio
      )
    ```
    
    Por lo tanto, teniendo una tasa de 3 por unidad de tiempo, la probabilidad de que ocurran menos de dos sucesos es de 0.19.
    
e.  Calcule $P(X > 2)$.

    ```{r}
    ppois(
      q = 3, # Valor de X para el cual se desea calcular la probabilidad
      lambda = 3, # Tasa de ocurrencia por unidad de tiempo o espacio
      lower.tail = FALSE # En caso de que se tenga el signo mayor estricto
      )
    ```
    
    Por lo tanto, teniendo una tasa de 3 por unidad de tiempo, la probabilidad de que ocurran más de dos sucesos es de 0.35.
    
f.  Calcule $P(X\geq 5)$.

    ```{r}
    ppois(
      q = 4, # Valor de X para el cual se desea calcular la probabilidad
      lambda = 3, # Tasa de ocurrencia por unidad de tiempo o espacio
      lower.tail = FALSE # En caso de que se tenga el signo mayor estricto
      )
    ```
    
    Por lo tanto, teniendo una tasa de 3 por unidad de tiempo, la probabilidad de que ocurran al menos cinco sucesos es de 0.18.
    
g.  Calcule $P(X\leq x) = 0.1$.
    
    ```{r}
    qpois(
      p = 0.1, # Valor resultante de la probabilidad
      lambda = 3 # Tasa de ocurrencia por unidad de tiempo o espacio
      )
    ```
    
    Por lo tanto, para $x=1$, la probabilidad de que ocurran a los más $x$ sucesos es de 0.1, considerando una tasa de 3 por unidad de tiempo.
:::

::: {.example}
Por un paradero pasan los buses de la línea $A$ a una razón de 12 por hora y en forma independiente pasan los buses de la línea $B$ a razón de 10 por hora. Un inspector observa la pasada de buses por el paradero.

1.  ¿Cuál es la probabilidad de que en los primeros 10 minutos no pasen buses de la línea $A$?
    
     La tasa de llegada de buses de la línea $A$ es de 12 por hora, por lo tanto, la tasa de llegada en 10 minutos es de 2 buses ($12/60\cdot 10=2$). La probabilidad de que no pase ningún bus en esos 10 minutos esta dada por $P(X = 0)$. En R:
     
    ```{r}
    dpois(
      x = 0, # Valor de X para el cual se desea calcular la probabilidad
      lambda = 2 # Tasa de ocurrencia por unidad de tiempo o espacio
    )
    ```
     
     Por lo tanto, la probabilidad de que en los primeros 10 minutos no pase ningún bus de la línea $A$ es de aproximadamente 0.13.

2.  ¿Cuál es la probabilidad de que en los primeros 8 minutos pasen menos de 3 buses de la línea $B$?

    La tasa de llegada en 8 minutos es de aproximadamente 1.333 buses $(10/60\cdot 8=1.333)$. Entonces, la probabilidad de que pasen menos de 3 buses de la línea $B$ en esos 8 minutos esta dada por $P(X < 3) = P(X\leq 2)$. En R:
    
    ```{r}
    ppois(
      q = 2, # Valor de X para el cual se desea calcular la probabilidad
      lambda = 1.333 # Tasa de ocurrencia por unidad de tiempo o espacio
    )
    ```
    
    La probabilidad de que en los primeros 8 minutos pasen menos de 3 buses de la línea $B$ es de aproximadamente 0.84.
:::

::: {.exercise}
Una compañía de seguros tiene un promedio de 4 reclamaciones de seguros de automóviles por día.

1.  ¿Cuál es la probabilidad de que la compañía de seguros reciba menos de 3 reclamaciones en un día?
2.  Si la compañía de seguros quiere asegurarse de tener suficientes empleados para manejar la carga de trabajo, ¿cuántos empleados deben tener en su equipo si quieren tener una probabilidad del 90% de manejar cualquier cantidad de reclamaciones en un día?
3.  Si la compañía de seguros quiere limitar su riesgo y sólo estar dispuesta a pagar por un número limitado de reclamaciones, ¿cuál es la cantidad máxima de reclamaciones que deberían estar dispuestos a pagar por día si sólo están dispuestos a aceptar un riesgo del 5% de exceder ese límite?
:::

::: {.exercise}
Un banco recibe en promedio 2 solicitudes de préstamos hipotecarios por hora.

1.  ¿Cuál es la probabilidad de que el banco reciba exactamente 3 solicitudes de préstamo hipotecario en un período de 90 minutos?
2.  Si el banco quiere asegurarse de tener suficiente personal para manejar una alta demanda de solicitudes de préstamo, ¿cuántos empleados deben tener en su equipo si quieren tener una probabilidad del 95% de manejar cualquier cantidad de solicitudes en una hora?
3.  Si el banco quiere limitar su exposición a riesgos y sólo estar dispuesto a aprobar un número limitado de préstamos, ¿cuál es la cantidad máxima de solicitudes que deberían estar dispuestos a aprobar por hora si sólo están dispuestos a aceptar un riesgo del 10% de exceder ese límite?
:::

::: {.exercise}
Un laboratorio farmacéutico encarga una encuesta para estimar el consumo de cierto medicamento que, elabora con el fin de controlar su producción. Se sabe que, a lo largo de un año cada persona tiene una posibilidad entre mil de necesitar el medicamento, y el laboratorio podrá vender en promedio 4000 unidades del producto por año.

1. ¿Cuál es la probabilidad de que el número de enfermos no exceda 4 por año?
2. ¿Cuál es la probabilidad de que el número de enfermos sea más de 2 por año? 
3. ¿Cuál es la probabilidad de que haya 12 enfermos en un año? 
:::

## Variables aleatorias continuas (v.a.c)

### Función de densidad de probabilidad
### Función de distribución acumulada

### Distribuciones
#### Uniforme {.unlisted .unnumbered}
#### Exponencial {.unlisted .unnumbered} 
#### Normal {.unlisted .unnumbered} 
#### T - Student {.unlisted .unnumbered} 
#### Ji - Cuadrado {.unlisted .unnumbered}

## Esperanza

### v.a.d
### v.a.c

## Varianza

### v.a.d
### v.a.c





















































